spring.application.name=coinTrack

# Server port (use Render's PORT env var, fallback to 8080)
server.port=${PORT:8080}

# MongoDB Atlas Configuration (use environment variables to avoid committing secrets)
# Provide these on your hosting platform (Render) or locally via .env
spring.data.mongodb.uri=${MONGODB_URI}
spring.data.mongodb.database=${MONGODB_DB:Finance}

# DevTools Configuration for Automatic Restart
spring.devtools.restart.enabled=true
spring.devtools.livereload.enabled=true

# Redirect URLs (use environment variables in production to avoid committing hostnames)
# Provide ZERODHA_REDIRECT_URL, ANGELONE_REDIRECT_URL, UPSTOX_REDIRECT_URL, FRONTEND_URL in your environment
# IMPORTANT: ZERODHA_REDIRECT_URL must ALSO be configured in Zerodha Developer Console!
frontend.url=${FRONTEND_URL:http://localhost:3000}
zerodha.redirect.url=${ZERODHA_REDIRECT_URL:${BASE_URL:http://localhost:8080}/api/kite/callback}


# AngelOne Redirect URL
angelone.redirect.url=${ANGELONE_REDIRECT_URL:https://cointrack-15gt.onrender.com/api/angelone/callback}

# Upstox Redirect URL
upstox.redirect.url=${UPSTOX_REDIRECT_URL:${BASE_URL:http://localhost:8080}/api/upstox/callback}

# Encryption Configuration (REQUIRED for TOTP secret encryption)
# IMPORTANT: Generate a strong 32-character key for production!
# Example: openssl rand -base64 24 | cut -c1-32
app.encryption.secret-key=${ENCRYPTION_SECRET_KEY}

# JWT Configuration
jwt.secret=${JWT_SECRET}

# TOTP Configuration
# Generate with: openssl rand -hex 32
# WARNING: The default key below is for DEVELOPMENT ONLY. Set TOTP_ENCRYPTION_KEY env var in production!
totp.encryption-key=${TOTP_ENCRYPTION_KEY:a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2}
totp.issuer=CoinTrack
totp.window=1
totp.max-backup-codes=10

# ============================================================================
# BREVO EMAIL API CONFIGURATION (Replaces SMTP for cloud deployment)
# ============================================================================
# Brevo (Sendinblue) REST API - Works on Render/Vercel/Railway
# Uses HTTPS (port 443) instead of SMTP (ports 25, 587, 465 which are blocked)
# Get API key from: https://app.brevo.com/settings/keys/api
# Free tier: 300 emails/day
brevo.api-key=${BREVO_API_KEY:}
brevo.sender-email=${BREVO_SENDER_EMAIL:no-reply@cointrack.app}
brevo.sender-name=${BREVO_SENDER_NAME:CoinTrack}

# ============================================================================
# EMAIL CONFIGURATION
# ============================================================================
# LEGACY SMTP SETTINGS (DISABLED â€“ Gmail SMTP blocked on cloud providers)
# These settings are kept for local development only.
# In production (Render), Brevo API is used instead.
# To disable SMTP attempts in production, remove MAIL_* env vars from Render.
spring.mail.host=${MAIL_HOST:smtp.gmail.com}
spring.mail.port=${MAIL_PORT:587}
spring.mail.username=${MAIL_USERNAME:}
spring.mail.password=${MAIL_PASSWORD:}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.connectiontimeout=20000
spring.mail.properties.mail.smtp.timeout=20000
spring.mail.properties.mail.smtp.writetimeout=20000

# Email App Settings
email.from=${EMAIL_FROM:noreply@cointrack.app}
email.support=${EMAIL_SUPPORT:support@cointrack.app}
email.base-url=${EMAIL_BASE_URL:https://cointrack-finance.vercel.app}
email.magic-link-expiry-minutes=10
# IMPORTANT: Generate a strong secret for production!
# Example: openssl rand -base64 32
email.magic-link-secret=${EMAIL_MAGIC_LINK_SECRET:dev-secret-change-in-production-32chars!}
# Backend API URL for serving static assets (logo) in emails
email.api-base-url=${EMAIL_API_BASE_URL:https://cointrack-15gt.onrender.com}

# Thymeleaf Email Templates
spring.thymeleaf.prefix=classpath:/templates/
spring.thymeleaf.suffix=.html
spring.thymeleaf.mode=HTML
spring.thymeleaf.cache=false

# ============================================================================
# LOGGING CONFIGURATION
# ============================================================================
# Suppress Spring Security AuthenticationProvider warning (intentional config)
logging.level.org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer=ERROR
